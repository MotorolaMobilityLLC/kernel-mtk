/*
 * Copyright (C) 2016 MediaTek Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See http://www.gnu.org/licenses/gpl-2.0.html for more details.
 */

#include <linux/init.h>
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/spinlock.h>
#include <linux/delay.h>
#include <linux/of_fdt.h>
#include <mt-plat/mtk_secure_api.h>

#ifdef CONFIG_OF
#include <linux/of.h>
#include <linux/of_irq.h>
#include <linux/of_address.h>
#endif

#include <mt-plat/upmu_common.h>
#include <mt-plat/mtk_chip.h>

#include <mtk_spm_misc.h>
#include <mtk_spm_vcore_dvfs.h>
#include <mtk_spm_internal.h>
#include <mtk_spm_pmic_wrap.h>
#include <mtk_dvfsrc_reg.h>
#include <mtk_eem.h>
#include <ext_wd_drv.h>

#ifdef CONFIG_MTK_SMI_EXT
#include <mmdvfs_mgr.h>
#endif

#define is_dvfs_in_progress()    (spm_read(DVFS_LEVEL) & 0x1F)
#define get_dvfs_level()         (spm_read(DVFS_LEVEL) & 0x1F)

/*
 * only for internal debug
 */
#define SPM_VCOREFS_TAG	"[VcoreFS] "
#define spm_vcorefs_err(fmt, args...)	pr_err(SPM_VCOREFS_TAG fmt, ##args)
#define spm_vcorefs_warn(fmt, args...)	pr_warn(SPM_VCOREFS_TAG fmt, ##args)
#define spm_vcorefs_debug(fmt, args...)	pr_debug(SPM_VCOREFS_TAG fmt, ##args)

void __iomem *dvfsrc_base;

u32 plat_channel_num;
u32 plat_chip_ver;

#ifdef CONFIG_MTK_SMI_EXT
mmdvfs_lcd_size_enum plat_lcd_resolution;
#else
int plat_lcd_resolution;
#endif

enum spm_vcorefs_step {
	SPM_VCOREFS_ENTER = 0x00000001,
	SPM_VCOREFS_DVFS_START = 0x000000ff,
	SPM_VCOREFS_DVFS_END = 0x000001ff,
	SPM_VCOREFS_LEAVE = 0x000007ff,
};

static inline void spm_vcorefs_footprint(enum spm_vcorefs_step step)
{
#ifdef CONFIG_MTK_RAM_CONSOLE
	aee_rr_rec_vcore_dvfs_status(step);
#endif
}

#ifdef CONFIG_FPGA_EARLY_PORTING
static const u32 vcorefs_binary[] = {
	0xa1d58407, 0xa1d70407, 0x81f68407, 0x80358400, 0x1b80001f, 0x20000000,
	0x80300400, 0x80328400, 0xa1d28407, 0x81f20407, 0x81f88407, 0xe8208000,
	0x108c0610, 0x20000000, 0x81431801, 0xd8000245, 0x17c07c1f, 0x80318400,
	0x1880001f, 0x108c045c, 0xe0a00009, 0x1b80001f, 0x2000001a, 0xe0a0000b,
	0x1b80001f, 0x20000300, 0xe0a00009, 0x1b80001f, 0x20000c58, 0xe0a0000d,
	0xc0c08840, 0x17c07c1f, 0xe0a00005, 0x1b80001f, 0x2000001a, 0xe0a00001,
	0xe0a00000, 0xa1dd0407, 0x81f00407, 0x18d0001f, 0x108c0164, 0x80df0403,
	0xd82004e3, 0x17c07c1f, 0x81fd0407, 0xc2808900, 0x1290041f, 0xa19d8406,
	0xa1dc0407, 0x1880001f, 0x00000006, 0x1300081f, 0xf0000000, 0x17c07c1f,
	0x81fc0407, 0x1b00001f, 0xffffffff, 0x81fc8407, 0x1b80001f, 0x20000004,
	0x88c0000c, 0xffffffff, 0xd82008a3, 0x17c07c1f, 0xa1dc0407, 0x1b00001f,
	0x00000000, 0xd0000de0, 0x17c07c1f, 0xe8208000, 0x108c0610, 0x10000000,
	0xc0c08840, 0x17c07c1f, 0x1880001f, 0x108c045c, 0xe0a00001, 0x1b80001f,
	0x2000001a, 0xe0a00003, 0x1b80001f, 0x20000300, 0xe0a00001, 0x1b80001f,
	0x20000c58, 0xe0a00005, 0xe0a0000d, 0x1b80001f, 0x2000001a, 0xe0a00009,
	0xe0a00008, 0x81f00407, 0x81431801, 0xd8000c05, 0x17c07c1f, 0xa0118400,
	0x81bd8406, 0xa0128400, 0xa1dc0407, 0x1b00001f, 0x00000001, 0xc2808900,
	0x1290841f, 0xa1d88407, 0xa1d20407, 0x81f28407, 0xa1d68407, 0xa0100400,
	0xa0158400, 0x81f70407, 0x81f58407, 0xf0000000, 0x17c07c1f, 0x81409801,
	0xd8000f85, 0x17c07c1f, 0x18c0001f, 0x108c0318, 0xc0c07e80, 0x1200041f,
	0x80310400, 0x1b80001f, 0x2000000e, 0xa0110400, 0xe8208000, 0x108c0610,
	0x40000000, 0xe8208000, 0x108c0610, 0x00000000, 0xc2808900, 0x1291041f,
	0x18c0001f, 0x108c01d0, 0x1910001f, 0x108c01d0, 0xa1100404, 0xe0c00004,
	0xa19e0406, 0xa1dc0407, 0x1880001f, 0x00000058, 0x1300081f, 0xf0000000,
	0x17c07c1f, 0x18c0001f, 0x108c01d0, 0x1910001f, 0x108c01d0, 0x81300404,
	0xe0c00004, 0x81409801, 0xd80013c5, 0x17c07c1f, 0x18c0001f, 0x108c0318,
	0xc0c08320, 0x17c07c1f, 0xc2808900, 0x1291841f, 0x81be0406, 0xa1dc0407,
	0x1880001f, 0x00000006, 0x1300081f, 0xf0000000, 0x17c07c1f, 0xc0807700,
	0x17c07c1f, 0xc0807240, 0x17c07c1f, 0xe8208000, 0x102101a4, 0x00010000,
	0x18c0001f, 0x10230068, 0x1910001f, 0x10230068, 0x89000004, 0xffffff0f,
	0xe0c00004, 0x1910001f, 0x10230068, 0xe8208000, 0x108c0408, 0x00001fff,
	0xe8208000, 0x108c040c, 0xe0003fff, 0xa1d80407, 0xc2808900, 0x1292041f,
	0xa19e8406, 0x80cf1801, 0xa1dc0407, 0xd8001923, 0x17c07c1f, 0x1880001f,
	0x00010060, 0xd0001960, 0x17c07c1f, 0x1880001f, 0x000100a0, 0x1300081f,
	0xf0000000, 0x17c07c1f, 0xe8208000, 0x108c040c, 0xffff3fff, 0xe8208000,
	0x108c0408, 0x00001fff, 0x1b80001f, 0x20000fdf, 0x81f80407, 0x80cf9801,
	0xd8001b83, 0x17c07c1f, 0xc0c07240, 0x17c07c1f, 0xe8208000, 0x108c0408,
	0x04003fff, 0x1910001f, 0x108c0170, 0xd8201be3, 0x80c41001, 0x1910001f,
	0x10230068, 0x18c0001f, 0x10230068, 0xa9000004, 0x000000f0, 0xe0c00004,
	0x1910001f, 0x10230068, 0x1880001f, 0x108c0028, 0xc0c084e0, 0xe080000f,
	0xd8201ea3, 0x17c07c1f, 0xa1d80407, 0xd0002180, 0x17c07c1f, 0xe080001f,
	0xe8208000, 0x102101a8, 0x00070000, 0xc0806e00, 0x17c07c1f, 0xc0806f80,
	0x17c07c1f, 0xc2808900, 0x1292841f, 0x81be8406, 0xa19f8406, 0x80cf1801,
	0xa1dc0407, 0xd8002123, 0x17c07c1f, 0x1880001f, 0x00000058, 0xd0002160,
	0x17c07c1f, 0x1880001f, 0x00000090, 0x1300081f, 0xf0000000, 0x17c07c1f,
	0x816f9801, 0x814e9805, 0xd8202285, 0x17c07c1f, 0xc0c07240, 0x17c07c1f,
	0x18c0001f, 0x108c038c, 0xe0e00011, 0xe0e00031, 0xe0e00071, 0xe0e000f1,
	0xe0e001f1, 0xe0e003f1, 0xe0e007f1, 0xe0e00ff1, 0xe0e01ff1, 0xe0e03ff1,
	0xe0e07ff1, 0xe0f07ff1, 0x1b80001f, 0x20000020, 0xe0f07ff3, 0xe0f07ff2,
	0x80350400, 0x1b80001f, 0x2000001a, 0x80378400, 0x1b80001f, 0x20000208,
	0x80338400, 0x1b80001f, 0x2000001a, 0x81f98407, 0xc2808900, 0x1293041f,
	0xa19f0406, 0x80ce9801, 0xa1dc0407, 0xd8002763, 0x17c07c1f, 0x1880001f,
	0x00000090, 0xd0002880, 0x17c07c1f, 0x80cf9801, 0xd8002843, 0x17c07c1f,
	0x1880001f, 0x000100a0, 0xd0002880, 0x17c07c1f, 0x1880001f, 0x000080a0,
	0x1300081f, 0x816f9801, 0x814e9805, 0xd8202a65, 0x17c07c1f, 0xc0c084e0,
	0x17c07c1f, 0x1880001f, 0x108c0028, 0xe080000f, 0xd8002a63, 0x17c07c1f,
	0xe080001f, 0xc0c06e00, 0x17c07c1f, 0xf0000000, 0x17c07c1f, 0x816f9801,
	0x814e9805, 0xd8202b65, 0x17c07c1f, 0xc0c07240, 0x17c07c1f, 0xa1d98407,
	0xa0138400, 0xa0178400, 0xa0150400, 0x18c0001f, 0x108c038c, 0xe0f07ff3,
	0xe0f07ff1, 0xe0e00ff1, 0xe0e000f1, 0xe0e00001, 0xc2808900, 0x1293841f,
	0x81bf0406, 0x80ce9801, 0xa1dc0407, 0xd8002e23, 0x17c07c1f, 0x1880001f,
	0x00000058, 0xd0002f40, 0x17c07c1f, 0x80cf9801, 0xd8202f03, 0x17c07c1f,
	0x1880001f, 0x00010060, 0xd0002f40, 0x17c07c1f, 0x1880001f, 0x00008060,
	0x1300081f, 0x816f9801, 0x814e9805, 0xd8203125, 0x17c07c1f, 0xc0c084e0,
	0x17c07c1f, 0x1880001f, 0x108c0028, 0xe080000f, 0xd8003123, 0x17c07c1f,
	0xe080001f, 0xc0c06e00, 0x17c07c1f, 0xf0000000, 0x17c07c1f, 0xc0c07240,
	0x17c07c1f, 0xc2808900, 0x1294041f, 0xa19f8406, 0x80cf1801, 0xa1dc0407,
	0xd8003303, 0x17c07c1f, 0x1880001f, 0x00010060, 0xd0003340, 0x17c07c1f,
	0x1880001f, 0x000100a0, 0x1300081f, 0xf0000000, 0x17c07c1f, 0x1880001f,
	0x108c0028, 0xc0c084e0, 0xe080000f, 0xd8003683, 0x17c07c1f, 0xe080001f,
	0xc0806e00, 0x17c07c1f, 0xc2808900, 0x1294841f, 0x81bf8406, 0x80cf1801,
	0xa1dc0407, 0xd8003623, 0x17c07c1f, 0x1880001f, 0x00008060, 0xd0003660,
	0x17c07c1f, 0x1880001f, 0x000080a0, 0x1300081f, 0xf0000000, 0x17c07c1f,
	0x1a00001f, 0x108c0478, 0xe200001f, 0x18d0001f, 0x108c0474, 0x1900001f,
	0x108c0474, 0xa8c00003, 0x00000300, 0xe1000003, 0x18d0001f, 0x108c0474,
	0x610e8c01, 0xd8203804, 0x17c07c1f, 0x81520406, 0xd8003a45, 0x17c07c1f,
	0x803d0400, 0x803d8400, 0xa01f0400, 0xa01f8400, 0x80cc1801, 0xc9206603,
	0x17c07c1f, 0xc90069c3, 0x17c07c1f, 0x91bc0406, 0x18d0001f, 0x108c0474,
	0x1900001f, 0x108c0474, 0x88c00003, 0xfffffc00, 0xe1000003, 0xe2201120,
	0xe2200120, 0xc0c06d80, 0x17c07c1f, 0x81518406, 0xd8003ce5, 0x17c07c1f,
	0x1900001f, 0x108c0400, 0xe1200002, 0xc0c08ac0, 0x17c07c1f, 0x1b80001f,
	0x2000035a, 0xe2200101, 0xe8208000, 0x103328d0, 0x00000010, 0xe8208000,
	0x10332ed0, 0x00000013, 0xe8208000, 0x103334d0, 0x0000000c, 0xe8208000,
	0x10333ad0, 0x00000008, 0x1b00001f, 0x00001e00, 0xf0000000, 0x17c07c1f,
	0x18d0001f, 0x108c0478, 0x1a00001f, 0x108c0478, 0xe200001f, 0x88c00003,
	0x0000001f, 0x22708403, 0xd82044a9, 0x17c07c1f, 0x18d0001f, 0x108c0474,
	0x1900001f, 0x108c0474, 0xa8c00003, 0x00000300, 0xe1000003, 0x18d0001f,
	0x108c0474, 0x610e8c01, 0xd8204124, 0x17c07c1f, 0x81520406, 0xd8004365,
	0x17c07c1f, 0x803d0400, 0x803d8400, 0xa01f8400, 0x803f0400, 0x80cc1801,
	0xc9206603, 0x17c07c1f, 0xc90069c3, 0x17c07c1f, 0x91bc0406, 0x18d0001f,
	0x108c0474, 0x1900001f, 0x108c0474, 0x88c00003, 0xfffffc00, 0xe1000003,
	0xe2202200, 0xd8204689, 0x17c07c1f, 0xe2200220, 0xc0c06d80, 0x17c07c1f,
	0x81518406, 0xd8004645, 0x17c07c1f, 0x1900001f, 0x108c0400, 0xe1200003,
	0xc0c08ac0, 0x17c07c1f, 0x1b80001f, 0x2000035a, 0xd8204049, 0x17c07c1f,
	0xe2200202, 0xe8208000, 0x103328d0, 0x0000000b, 0xe8208000, 0x10332ed0,
	0x0000000c, 0xe8208000, 0x103334d0, 0x00000008, 0xe8208000, 0x10333ad0,
	0x00000005, 0x1b00001f, 0x00001d00, 0xf0000000, 0x17c07c1f, 0x18d0001f,
	0x108c0478, 0x1a00001f, 0x108c0478, 0xe200001f, 0x88c00003, 0x0000001f,
	0x22710403, 0x60f18403, 0xd8204a43, 0x17c07c1f, 0xd0004ee0, 0x1240041f,
	0xd8204ee9, 0x17c07c1f, 0x18d0001f, 0x108c0474, 0x1900001f, 0x108c0474,
	0xa8c00003, 0x00000300, 0xe1000003, 0x18d0001f, 0x108c0474, 0x610e8c01,
	0xd8204b64, 0x17c07c1f, 0x81520406, 0xd8004da5, 0x17c07c1f, 0x803d0400,
	0x803d8400, 0x803f8400, 0x803f0400, 0x80cc1801, 0xc9206603, 0x17c07c1f,
	0xc90069c3, 0x17c07c1f, 0x91bc0406, 0x18d0001f, 0x108c0474, 0x1900001f,
	0x108c0474, 0x88c00003, 0xfffffc00, 0xe1000003, 0xe2204400, 0xd82050c9,
	0x17c07c1f, 0xe2200420, 0xc0c06d80, 0x17c07c1f, 0x81518406, 0xd8005085,
	0x17c07c1f, 0x1900001f, 0x108c0400, 0xe1200004, 0xc0c08ac0, 0x17c07c1f,
	0x1b80001f, 0x2000035a, 0xd8204a89, 0x17c07c1f, 0xe2200404, 0xe8208000,
	0x103328d0, 0x00000008, 0xe8208000, 0x10332ed0, 0x00000009, 0xe8208000,
	0x103334d0, 0x00000006, 0xe8208000, 0x10333ad0, 0x00000004, 0x1b00001f,
	0x00001b00, 0xf0000000, 0x17c07c1f, 0x18d0001f, 0x108c0478, 0x1a00001f,
	0x108c0478, 0xe200001f, 0x88c00003, 0x0000001f, 0x32718403, 0x60f10403,
	0xd8205483, 0x17c07c1f, 0xd00054c0, 0x1240041f, 0xd80056a9, 0x17c07c1f,
	0xe2200820, 0xc0c06d80, 0x17c07c1f, 0x81518406, 0xd8005665, 0x17c07c1f,
	0x1900001f, 0x108c0400, 0xe1200005, 0xc0c08ac0, 0x17c07c1f, 0x1b80001f,
	0x2000035a, 0xd8005ac9, 0x17c07c1f, 0x18d0001f, 0x108c0474, 0x1900001f,
	0x108c0474, 0xa8c00003, 0x00000300, 0xe1000003, 0x18d0001f, 0x108c0474,
	0x610e8c01, 0xd8205784, 0x17c07c1f, 0x81520406, 0xd80059c5, 0x17c07c1f,
	0x803d0400, 0x803d8400, 0x803f8400, 0x803f0400, 0x80cc1801, 0xc9206603,
	0x17c07c1f, 0xc90069c3, 0x17c07c1f, 0x91bc0406, 0x18d0001f, 0x108c0474,
	0x1900001f, 0x108c0474, 0x88c00003, 0xfffffc00, 0xe1000003, 0xe2204800,
	0xe2200808, 0xe8208000, 0x103328d0, 0x00000008, 0xe8208000, 0x10332ed0,
	0x00000009, 0xe8208000, 0x103334d0, 0x00000006, 0xe8208000, 0x10333ad0,
	0x00000004, 0x1b00001f, 0x00001700, 0xf0000000, 0x17c07c1f, 0x18d0001f,
	0x108c0478, 0x1a00001f, 0x108c0478, 0xe200001f, 0x88c00003, 0x0000001f,
	0x32718403, 0xd8005fc9, 0x17c07c1f, 0xe2200820, 0xc0c06d80, 0x17c07c1f,
	0x81518406, 0xd8005fc5, 0x17c07c1f, 0x1900001f, 0x108c0400, 0xe1200005,
	0xc0c08ac0, 0x17c07c1f, 0x1b80001f, 0x2000035a, 0x18d0001f, 0x108c0474,
	0x1900001f, 0x108c0474, 0xa8c00003, 0x00000300, 0xe1000003, 0x18d0001f,
	0x108c0474, 0x610e8c01, 0xd82060a4, 0x17c07c1f, 0x81520406, 0xd80062e5,
	0x17c07c1f, 0x803d0400, 0x803d8400, 0x803f8400, 0xa01f0400, 0x80cc1801,
	0xc9206603, 0x17c07c1f, 0xc90069c3, 0x17c07c1f, 0x91bc0406, 0x18d0001f,
	0x108c0474, 0x1900001f, 0x108c0474, 0x88c00003, 0xfffffc00, 0xe1000003,
	0xe2300800, 0xe2200810, 0xe8208000, 0x103328d0, 0x00000007, 0xe8208000,
	0x10332ed0, 0x00000008, 0xe8208000, 0x103334d0, 0x00000005, 0xe8208000,
	0x10333ad0, 0x00000003, 0x1b00001f, 0x00000f00, 0xf0000000, 0x17c07c1f,
	0xa01d0400, 0x1b80001f, 0x20000002, 0xa01e0400, 0x1b80001f, 0x20000551,
	0xa1d18407, 0x808cb401, 0xd82066e2, 0x17c07c1f, 0xa01c0400, 0xe8208000,
	0x108c0620, 0x00000001, 0xa01c8400, 0x808bb401, 0xd82067e2, 0x17c07c1f,
	0x81f18407, 0x803c8400, 0x808f8001, 0xd8006942, 0x17c07c1f, 0xe8208000,
	0x108c0620, 0x00004001, 0x803c0400, 0x803e8400, 0xf0000000, 0x17c07c1f,
	0xa01d8400, 0x1b80001f, 0x20000002, 0xa01e8400, 0x1b80001f, 0x20000551,
	0xa1d18407, 0x808cb401, 0xd8206aa2, 0x17c07c1f, 0xa01c0400, 0xe8208000,
	0x108c0620, 0x00000001, 0xa01c8400, 0x808bb401, 0xd8206ba2, 0x17c07c1f,
	0x81f18407, 0x803c8400, 0x808f8001, 0xd8006d02, 0x17c07c1f, 0xe8208000,
	0x108c0620, 0x00004001, 0x803c0400, 0x803e0400, 0xf0000000, 0x17c07c1f,
	0x1b80001f, 0x20000108, 0xf0000000, 0x17c07c1f, 0xa1da0407, 0xa1dd8407,
	0xa0188400, 0xa0190400, 0xa0110400, 0x80398400, 0x803a0400, 0x803a8400,
	0x803b0400, 0x80380400, 0xf0000000, 0x17c07c1f, 0xa1da0407, 0xa1dd8407,
	0x803b8400, 0xa0168400, 0xa0140400, 0x81411801, 0xd8007205, 0x17c07c1f,
	0xe8208000, 0x108c0320, 0x00000f0d, 0xe8208000, 0x108c0320, 0x00000f0f,
	0xe8208000, 0x108c0320, 0x00000f1e, 0xe8208000, 0x108c0320, 0x00000f12,
	0xf0000000, 0x17c07c1f, 0xa01b0400, 0xa01a8400, 0xa01c0400, 0xa01a0400,
	0x1b80001f, 0x2000000a, 0xa0198400, 0x1b80001f, 0x2000000a, 0x80388400,
	0x80310400, 0x803c0400, 0x1b80001f, 0x20000004, 0x80390400, 0x81fa0407,
	0x81fd8407, 0xe8208000, 0x108c0620, 0x00001000, 0x1b80001f, 0x20000003,
	0xe8208000, 0x108c0620, 0x00000000, 0x808f8001, 0xd8007622, 0x17c07c1f,
	0xe8208000, 0x108c0620, 0x00004000, 0x81f08407, 0x808ab401, 0xd8007642,
	0x17c07c1f, 0x80380400, 0xf0000000, 0x17c07c1f, 0x81411801, 0xd8007b05,
	0x17c07c1f, 0xe8208000, 0x108c0320, 0x00000f16, 0xe8208000, 0x108c0320,
	0x00000f1e, 0xe8208000, 0x108c0320, 0x00000f0e, 0x1b80001f, 0x2000001b,
	0xe8208000, 0x108c0320, 0x00000f0c, 0xe8208000, 0x108c0320, 0x00000f0d,
	0xe8208000, 0x108c0320, 0x00000e0d, 0xe8208000, 0x108c0320, 0x00000c0d,
	0xe8208000, 0x108c0320, 0x0000080d, 0xe8208000, 0x108c0320, 0x0000000d,
	0x80340400, 0x80368400, 0x1b80001f, 0x20000209, 0xa0180400, 0xe8208000,
	0x108c0620, 0x00000100, 0x1b80001f, 0x20000003, 0xe8208000, 0x108c0620,
	0x00000500, 0x1b80001f, 0x20000003, 0xe8208000, 0x108c0620, 0x00000100,
	0x1b80001f, 0x20000006, 0xe8208000, 0x108c0620, 0x00000000, 0xa01b8400,
	0x1b80001f, 0x20000209, 0xf0000000, 0x17c07c1f, 0xe0f07f16, 0x1380201f,
	0xe0f07f1e, 0x1380201f, 0xe0f07f0e, 0xe0f07f0c, 0x1900001f, 0x108c0374,
	0xe120003e, 0xe120003c, 0xe1200038, 0xe1200030, 0xe1200020, 0xe1200000,
	0x1880001f, 0x108c03a4, 0x1900001f, 0x0400fffc, 0xe0800004, 0x1900001f,
	0x0000fffc, 0xe0800004, 0x1b80001f, 0x20000104, 0xe0f07f0d, 0xe0f07e0d,
	0x1b80001f, 0x20000104, 0xe0f07c0d, 0x1b80001f, 0x20000104, 0xe0f0780d,
	0x1b80001f, 0x20000104, 0xe0f0700d, 0xf0000000, 0x17c07c1f, 0x1900001f,
	0x108c0374, 0xe120003f, 0x1900001f, 0x108c03a4, 0x1880001f, 0x0c00fffc,
	0xe1000002, 0xe0f07f0d, 0xe0f07f0f, 0xe0f07f1e, 0xe0f07f12, 0xf0000000,
	0x17c07c1f, 0xa0180400, 0x1111841f, 0xa1d08407, 0xd82085c4, 0x80eab401,
	0xd8008543, 0x01200404, 0xd8208723, 0x17c07c1f, 0xa1dc0407, 0x1b00001f,
	0x00000000, 0x81fc0407, 0x80380400, 0x81f08407, 0xe8208000, 0x108c00b0,
	0x00000001, 0xf0000000, 0x17c07c1f, 0xa1d10407, 0x1b80001f, 0x20000020,
	0x1b80001f, 0x20000020, 0xf0000000, 0x17c07c1f, 0xa1d00407, 0x1b80001f,
	0x20000208, 0x80ea3401, 0xf0000000, 0x17c07c1f, 0x18c0001f, 0x108c0604,
	0x1910001f, 0x108c0604, 0xa1002804, 0xe0c00004, 0xf0000000, 0x17c07c1f,
	0xa1d40407, 0x1391841f, 0xa1d90407, 0x1392841f, 0xf0000000, 0x17c07c1f,
	0x1b80001f, 0x20000300, 0xf0000000, 0x17c07c1f, 0xe8208000, 0x110e0014,
	0x00000002, 0xe8208000, 0x110e0020, 0x00000001, 0xe8208000, 0x110e0004,
	0x000000d6, 0x1a00001f, 0x110e0000, 0x1880001f, 0x110e0024, 0x18c0001f,
	0x20000152, 0xd8208f6a, 0x17c07c1f, 0xe220000a, 0xe22000f6, 0xe8208000,
	0x110e0024, 0x00000001, 0x1b80001f, 0x20000152, 0xe220008a, 0xe2200001,
	0xe8208000, 0x110e0024, 0x00000001, 0x1b80001f, 0x20000152, 0xd0009120,
	0x17c07c1f, 0xe220008a, 0xe2200000, 0xe8208000, 0x110e0024, 0x00000001,
	0x1b80001f, 0x20000152, 0xe220000a, 0xe22000f4, 0xe8208000, 0x110e0024,
	0x00000001, 0x1b80001f, 0x20000152, 0xf0000000, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f, 0x17c07c1f,
	0x17c07c1f, 0x17c07c1f, 0x1840001f, 0x00000001, 0xa1d48407, 0xe8208000,
	0x108c0620, 0x00000000, 0x1990001f, 0x108c0600, 0xa9800006, 0xfe000000,
	0x1890001f, 0x108c061c, 0x80800402, 0xa19c0806, 0xe8208000, 0x108c0604,
	0x00000000, 0xe8208000, 0x108c0608, 0x00000000, 0x81550406, 0xd8012105,
	0x17c07c1f, 0x81fc0407, 0x1b00001f, 0xffffffff, 0xa1dc0407, 0x1b00001f,
	0x00000000, 0x81401801, 0xd8010485, 0x17c07c1f, 0x1b80001f, 0x5000aaaa,
	0xd00105c0, 0x17c07c1f, 0x1b80001f, 0xd00f0000, 0x81fc8407, 0x18c0001f,
	0x108c0608, 0xe0c0000c, 0x8880000c, 0xffffffff, 0xd8011d42, 0x17c07c1f,
	0xe8208000, 0x108c0408, 0x00001fff, 0xe8208000, 0x108c040c, 0xe0003fff,
	0xc0c08760, 0x81401801, 0xd8010a65, 0x17c07c1f, 0x80c41801, 0xd8010783,
	0x17c07c1f, 0x81f60407, 0x18d0001f, 0x108c0254, 0xc0c126a0, 0x17c07c1f,
	0x81461801, 0xd8010a65, 0x17c07c1f, 0x18d0001f, 0x108c0250, 0xc0c12a80,
	0x17c07c1f, 0x81469801, 0xd8010a65, 0x17c07c1f, 0x18c0001f, 0x108c0200,
	0xc0c12fe0, 0x17c07c1f, 0xe8208000, 0x108c0260, 0x00000007, 0xc2808900,
	0x1296041f, 0x81401801, 0xd8010c65, 0x17c07c1f, 0xa1dc0407, 0x1b00001f,
	0x00000000, 0x1b80001f, 0x30000004, 0x81fc8407, 0x18c0001f, 0x108c0608,
	0xe0c0000c, 0x8880000c, 0xffffffff, 0xd8011982, 0x17c07c1f, 0x81489801,
	0xd8010d65, 0x17c07c1f, 0x18c0001f, 0x108c037c, 0xe0e00013, 0xe0e00011,
	0xe0e00001, 0x81481801, 0xd8010ea5, 0x17c07c1f, 0x18c0001f, 0x108c0370,
	0xe0f07ff3, 0xe0f07ff1, 0xe0e00ff1, 0xe0e000f1, 0xe0e00001, 0x81449801,
	0xd8010f05, 0x17c07c1f, 0xc0c08a00, 0x17c07c1f, 0xa1d38407, 0xa0108400,
	0xa0120400, 0xa0130400, 0xa0170400, 0xa0148400, 0xe8208000, 0x108c0080,
	0x000003ff, 0xa1dc0407, 0x18c0001f, 0x000100a0, 0x13000c1f, 0x1b80001f,
	0x90100000, 0x80cd9801, 0xc8e00003, 0x17c07c1f, 0x80ce1801, 0xc8e00e23,
	0x17c07c1f, 0x80cf1801, 0xc8e021c3, 0x17c07c1f, 0x80cf9801, 0xc8e03163,
	0x17c07c1f, 0x80ce9801, 0xc8e014e3, 0x17c07c1f, 0x81fc8407, 0x18c0001f,
	0x108c0608, 0xe0c0000c, 0x81481801, 0xd8011625, 0x17c07c1f, 0x18c0001f,
	0x108c0370, 0xe0e00011, 0xe0e00031, 0xe0e00071, 0xe0e000f1, 0xe0e001f1,
	0xe0e003f1, 0xe0e007f1, 0xe0e00ff1, 0xe0e01ff1, 0xe0e03ff1, 0xe0e07ff1,
	0xe0f07ff1, 0x1b80001f, 0x20000020, 0xe0f07ff3, 0xe0f07ff2, 0x81489801,
	0xd8011765, 0x17c07c1f, 0x18c0001f, 0x108c037c, 0xe0e00011, 0x1b80001f,
	0x20000020, 0xe0e00013, 0xe0e00012, 0x80348400, 0x1b80001f, 0x20000300,
	0x80370400, 0x1b80001f, 0x20000300, 0x80330400, 0x1b80001f, 0x20000104,
	0x80308400, 0x80320400, 0x81f38407, 0x81f90407, 0x81f40407, 0x81449801,
	0xd8011985, 0x17c07c1f, 0x81401801, 0xd8011d45, 0x17c07c1f, 0x81461801,
	0xd8011cc5, 0x17c07c1f, 0x81469801, 0xd8011c45, 0x17c07c1f, 0x18d0001f,
	0x108e0e10, 0x1880001f, 0x00000006, 0x81020c01, 0x80b09002, 0x18c0001f,
	0x108c0260, 0xe0c00002, 0x18c0001f, 0x108c0200, 0xc0c14760, 0x17c07c1f,
	0x18d0001f, 0x108c0250, 0xc0c13f20, 0x17c07c1f, 0x18d0001f, 0x108c0254,
	0xc0c13720, 0x17c07c1f, 0xe8208000, 0x108c0034, 0x000f0000, 0x81f48407,
	0xa1d60407, 0x81f10407, 0xa1db0407, 0xe8208000, 0x108c0620, 0x0000000f,
	0x18c0001f, 0x108c041c, 0x1910001f, 0x108c0164, 0xe0c00004, 0x18c0001f,
	0x108c0420, 0x1910001f, 0x108c0150, 0xe0c00004, 0x18c0001f, 0x108c0424,
	0x1910001f, 0x108c014c, 0xe0c00004, 0x1ac0001f, 0x55aa55aa, 0xe8208000,
	0x108e0e00, 0x00000001, 0x81f20407, 0x81f28407, 0x18c0001f, 0x108c001c,
	0x1910001f, 0x108c001c, 0xa9000004, 0x0b160000, 0x81328404, 0xe0c00004,
	0x1b80001f, 0x200009c4, 0xe8208000, 0x108c0030, 0xffffffff, 0xa1128404,
	0xe0c00004, 0xa1d48407, 0xc2808900, 0x1298041f, 0xe8208000, 0x108c0080,
	0x00007c00, 0x81fc0407, 0x1b00001f, 0x00000001, 0xa1dc0407, 0x1910001f,
	0x108c0478, 0xa134101f, 0x8b000004, 0x00001f00, 0x1b80001f, 0x90100000,
	0x18d0001f, 0x108c061c, 0x1900001f, 0x108c061c, 0xa08c1801, 0xa0c00c02,
	0xe1000003, 0x1ac0001f, 0x77887788, 0xf0000000, 0x17c07c1f, 0x1880001f,
	0x0000104d, 0xa0908402, 0xe2c00002, 0x80b30402, 0xe2c00002, 0xa0928402,
	0xe2c00002, 0x80b00402, 0xe2c00002, 0xa0920402, 0xe2c00002, 0x80b10402,
	0xe2c00002, 0x80b18402, 0xe2c00002, 0x80b60402, 0xe2c00002, 0xa0940402,
	0xe2c00002, 0x1950001f, 0x108c0254, 0x19300005, 0x17c07c1f, 0x810c1001,
	0xd8212924, 0x17c07c1f, 0xa0938402, 0xe2c00002, 0xf0000000, 0x17c07c1f,
	0x1880001f, 0x0000104d, 0xa0908402, 0xe2c00002, 0xa0928402, 0xe2c00002,
	0x80b30402, 0xe2c00002, 0x81598406, 0xd8212d45, 0x17c07c1f, 0xa0940402,
	0xe2c00002, 0x1950001f, 0x108c0250, 0x19300005, 0x17c07c1f, 0x810c1001,
	0xd8212c24, 0x17c07c1f, 0xd0012ea0, 0x17c07c1f, 0x1b80001f, 0x20000003,
	0x80b60402, 0xe2c00002, 0x1950001f, 0x108c0250, 0x19300005, 0x17c07c1f,
	0x810e1001, 0xd8012dc4, 0x17c07c1f, 0x80b00402, 0xe2c00002, 0xa0920402,
	0xe2c00002, 0x80b10402, 0xe2c00002, 0x80b18402, 0xe2c00002, 0xf0000000,
	0x17c07c1f, 0x1900001f, 0x10202008, 0x1950001f, 0x10202008, 0xa1400405,
	0x81708405, 0xe1000005, 0x1880001f, 0x0000104d, 0xa0908402, 0xe2c00002,
	0x1900001f, 0x108c0204, 0x1940001f, 0x0000104d, 0xa1528405, 0xe1000005,
	0x81730405, 0xe1000005, 0x82198406, 0xd82133c8, 0x17c07c1f, 0xa1540405,
	0xe1000005, 0x1950001f, 0x108c0204, 0x808c1401, 0xd82132e2, 0x17c07c1f,
	0xd00134e0, 0x17c07c1f, 0x1b80001f, 0x20000003, 0x81760405, 0xe1000005,
	0x1950001f, 0x108c0204, 0x808e1401, 0xd8013442, 0x17c07c1f, 0xa1538405,
	0xe1000005, 0x81700405, 0xe1000005, 0x1890001f, 0x108c0200, 0x80b00402,
	0xe2c00002, 0xa0920402, 0xe2c00002, 0x80b10402, 0xe2c00002, 0x80b18402,
	0xe2c00002, 0x1b80001f, 0x2000001a, 0xf0000000, 0x17c07c1f, 0x1880001f,
	0x00001332, 0x80b60402, 0xe2c00002, 0x80b00402, 0xe2c00002, 0xa0920402,
	0xe2c00002, 0xa0940402, 0xe2c00002, 0x1950001f, 0x108c0254, 0x19300005,
	0x17c07c1f, 0x810c1001, 0xd8213864, 0x17c07c1f, 0x80b38402, 0xe2c00002,
	0x80b40402, 0xe2c00002, 0x1950001f, 0x108c0254, 0x19300005, 0x17c07c1f,
	0x810c1001, 0xd80139c4, 0x17c07c1f, 0xa0910402, 0xe2c00002, 0x1b80001f,
	0x20000006, 0x1910001f, 0x108e0e10, 0x1950001f, 0x108c0188, 0x81001404,
	0xd8213b24, 0x17c07c1f, 0xa0918402, 0xe2c00002, 0x1910001f, 0x108e0e10,
	0x1950001f, 0x108c018c, 0x81001404, 0xd8213c44, 0x17c07c1f, 0xa0960402,
	0xe2c00002, 0xa0930402, 0xe2c00002, 0x80b08402, 0xe2c00002, 0x1b80001f,
	0x2000001a, 0x80b28402, 0xe2c00002, 0x80b20402, 0xe2c00002, 0xa0900402,
	0xe2c00002, 0xf0000000, 0x17c07c1f, 0x81598406, 0xd8013fe5, 0x17c07c1f,
	0xe1200032, 0xd0014000, 0x17c07c1f, 0xe1201332, 0xa0910402, 0xe2c00002,
	0x1b80001f, 0x20000006, 0xa0918402, 0xe2c00002, 0x1910001f, 0x108e0e14,
	0x1950001f, 0x108c0188, 0x81001404, 0xd82140c4, 0x17c07c1f, 0x1910001f,
	0x108e0e14, 0x1950001f, 0x108c018c, 0x81001404, 0xd82141a4, 0x17c07c1f,
	0x80b08402, 0xe2c00002, 0x81598406, 0xd8214485, 0x17c07c1f, 0x80b40402,
	0xe2c00002, 0x1950001f, 0x108c0250, 0x19300005, 0x17c07c1f, 0x810c1001,
	0xd8014364, 0x17c07c1f, 0xd00145a0, 0x17c07c1f, 0xa0960402, 0xe2c00002,
	0x1950001f, 0x108c0250, 0x19300005, 0x17c07c1f, 0x810e1001, 0xd82144c4,
	0x17c07c1f, 0x1b80001f, 0x2000001a, 0xa0930402, 0xe2c00002, 0x1b80001f,
	0x20000003, 0x80b28402, 0xe2c00002, 0x80b20402, 0xe2c00002, 0xa0900402,
	0xe2c00002, 0xf0000000, 0x17c07c1f, 0x18b0000b, 0x17c07c1f, 0xa0910402,
	0xe2c00002, 0xa0918402, 0xe2c00002, 0x80b08402, 0xe2c00002, 0x1950001f,
	0x108c0188, 0x81081401, 0x81079404, 0x1950001f, 0x108c018c, 0x81081404,
	0x81079404, 0xd8214864, 0x17c07c1f, 0x1900001f, 0x108c0204, 0x1950001f,
	0x108c0204, 0x82198406, 0xd8214be8, 0x17c07c1f, 0x81738405, 0xe1000005,
	0x81740405, 0xe1000005, 0x1950001f, 0x108c0204, 0x814c1401, 0xd8014b05,
	0x17c07c1f, 0xd0014d00, 0x17c07c1f, 0xa1560405, 0xe1000005, 0x81738405,
	0xe1000005, 0x1950001f, 0x108c0204, 0x814e1401, 0xd8214c65, 0x17c07c1f,
	0x1b80001f, 0x2000001a, 0x1950001f, 0x108c0204, 0xa1530405, 0xe1000005,
	0x1b80001f, 0x20000003, 0x81728405, 0xe1000005, 0x80b20402, 0xe2c00002,
	0xa0900402, 0xe2c00002, 0xa1500405, 0xe1000005, 0x1900001f, 0x10202008,
	0x1950001f, 0x10202008, 0xa1400405, 0x81708405, 0xe1000005, 0xf0000000,
	0x17c07c1f, 0xf0000000, 0x17c07c1f
};
static struct pcm_desc vcorefs_pcm = {
	.version	= "pcm_allinone_v4.2",
	.base		= vcorefs_binary,
	.size		= 2691,
	.sess		= 2,
	.replace	= 0,
	.addr_2nd	= 2045,
	.vec0		= EVENT_VEC(32, 1, 0, 0),	/* FUNC_26M_WAKEUP */
	.vec1		= EVENT_VEC(33, 1, 0, 54),	/* FUNC_26M_SLEEP */
	.vec2		= EVENT_VEC(34, 1, 0, 113),	/* FUNC_INFRA_WAKEUP */
	.vec3		= EVENT_VEC(35, 1, 0, 145),	/* FUNC_INFRA_SLEEP */
	.vec4		= EVENT_VEC(36, 1, 0, 167),	/* FUNC_APSRC_WAKEUP */
	.vec5		= EVENT_VEC(37, 1, 0, 206),	/* FUNC_APSRC_SLEEP */
	.vec6		= EVENT_VEC(38, 1, 0, 270),	/* FUNC_VRF18_WAKEUP */
	.vec7		= EVENT_VEC(39, 1, 0, 341),	/* FUNC_VRF18_SLEEP */
	.vec8		= EVENT_VEC(47, 1, 0, 395),	/* FUNC_DDREN_WAKEUP */
	.vec9		= EVENT_VEC(48, 1, 0, 413),	/* FUNC_DDREN_SLEEP */
	.vec10		= EVENT_VEC(40, 1, 0, 438),	/* FUNC_DVFS_LEVEL0 */
	.vec11		= EVENT_VEC(41, 1, 0, 504),	/* FUNC_DVFS_LEVEL1 */
	.vec12		= EVENT_VEC(42, 1, 0, 581),	/* FUNC_DVFS_LEVEL2 */
	.vec13		= EVENT_VEC(43, 1, 0, 663),	/* FUNC_DVFS_LEVEL3 */
	.vec14		= EVENT_VEC(44, 1, 0, 743),	/* FUNC_DVFS_LEVEL4 */
};
#endif

static struct pwr_ctrl vcorefs_ctrl = {
	.wake_src		= WAKE_SRC_R12_PCMTIMER,

	/* default VCORE DVFS is disabled */
	.pcm_flags		= (SPM_FLAG_RUN_COMMON_SCENARIO | SPM_FLAG_DIS_VCORE_DVS | SPM_FLAG_DIS_VCORE_DFS),

	/* Auto-gen Start */

	/* SPM_CLK_CON */
	.reg_srcclken0_ctl = 0,
	.reg_srcclken1_ctl = 0x3,
	.reg_spm_lock_infra_dcm = 1,
	.reg_srcclken_mask = 1,
	.reg_md1_c32rm_en = 0,
	.reg_md2_c32rm_en = 0,
	.reg_clksq0_sel_ctrl = 0,
	.reg_clksq1_sel_ctrl = 1,
	.reg_srcclken0_en = 1,
	.reg_srcclken1_en = 0,
	.reg_sysclk0_src_mask_b = 0,
	.reg_sysclk1_src_mask_b = 0x20,

	/* SPM_SRC_REQ */
	.reg_spm_apsrc_req = 0,
	.reg_spm_f26m_req = 0,
	.reg_spm_infra_req = 0,
	.reg_spm_ddren_req = 0,
	.reg_spm_vrf18_req = 0,
	.reg_spm_dvfs_level0_req = 0,
	.reg_spm_dvfs_level1_req = 0,
	.reg_spm_dvfs_level2_req = 0,
	.reg_spm_dvfs_level3_req = 0,
	.reg_spm_dvfs_level4_req = 0,
	.reg_spm_sspm_mailbox_req = 0,
	.reg_spm_sw_mailbox_req = 0,
	.reg_spm_cksel2_req = 0,
	.reg_spm_cksel3_req = 0,

	/* SPM_SRC_MASK */
	.reg_csyspwreq_mask = 1,
	.reg_md_srcclkena_0_infra_mask_b = 0,
	.reg_md_srcclkena_1_infra_mask_b = 0,
	.reg_md_apsrc_req_0_infra_mask_b = 0,
	.reg_md_apsrc_req_1_infra_mask_b = 0,
	.reg_conn_srcclkena_infra_mask_b = 0,
	.reg_conn_infra_req_mask_b = 0,
	.reg_sspm_srcclkena_infra_mask_b = 0,
	.reg_sspm_infra_req_mask_b = 0,
	.reg_scp_srcclkena_infra_mask_b = 0,
	.reg_scp_infra_req_mask_b = 0,
	.reg_srcclkeni0_infra_mask_b = 0,
	.reg_srcclkeni1_infra_mask_b = 0,
	.reg_srcclkeni2_infra_mask_b = 0,
	.reg_ccif0_md_event_mask_b = 0,
	.reg_ccif0_ap_event_mask_b = 0,
	.reg_ccif1_md_event_mask_b = 0,
	.reg_ccif1_ap_event_mask_b = 0,
	.reg_ccif2_md_event_mask_b = 0,
	.reg_ccif2_ap_event_mask_b = 0,
	.reg_ccif3_md_event_mask_b = 0,
	.reg_ccif3_ap_event_mask_b = 0,
	.reg_ccifmd_md1_event_mask_b = 0,
	.reg_ccifmd_md2_event_mask_b = 0,
	.reg_c2k_ps_rccif_wake_mask_b = 0,
	.reg_c2k_l1_rccif_wake_mask_b = 0,
	.reg_ps_c2k_rccif_wake_mask_b = 0,
	.reg_l1_c2k_rccif_wake_mask_b = 0,
	.reg_disp2_req_mask_b = 0,
	.reg_md_ddr_en_0_mask_b = 0,
	.reg_md_ddr_en_1_mask_b = 0,
	.reg_conn_ddr_en_mask_b = 0,

	/* SPM_SRC2_MASK */
	.reg_disp0_req_mask_b = 0,
	.reg_disp1_req_mask_b = 0,
	.reg_disp_od_req_mask_b = 0,
	.reg_mfg_req_mask_b = 0,
	.reg_vdec0_req_mask_b = 0,
	.reg_gce_req_mask_b = 0,
	.reg_gce_vrf18_req_mask_b = 0,
	.reg_lpdma_req_mask_b = 0,
	.reg_conn_srcclkena_cksel2_mask_b = 0,
	.reg_sspm_apsrc_req_ddren_mask_b = 0,
	.reg_scp_apsrc_req_ddren_mask_b = 0,
	.reg_md_vrf18_req_0_mask_b = 0,
	.reg_md_vrf18_req_1_mask_b = 0,
	.reg_next_dvfs_level0_mask_b = 1,
	.reg_next_dvfs_level1_mask_b = 1,
	.reg_next_dvfs_level2_mask_b = 1,
	.reg_next_dvfs_level3_mask_b = 1,
	.reg_next_dvfs_level4_mask_b = 1,
	.reg_sw2spm_int0_mask_b = 0,
	.reg_sw2spm_int1_mask_b = 0,
	.reg_sw2spm_int2_mask_b = 0,
	.reg_sw2spm_int3_mask_b = 0,
	.reg_sspm2spm_int0_mask_b = 0,
	.reg_sspm2spm_int1_mask_b = 0,
	.reg_sspm2spm_int2_mask_b = 0,
	.reg_sspm2spm_int3_mask_b = 0,
	.reg_dqssoc_req_mask_b = 0,

	/* SPM_SRC3_MASK */
	.reg_mpwfi_op = 0,
	.reg_spm_resource_req_rsv1_4_mask_b = 0,
	.reg_spm_resource_req_rsv1_3_mask_b = 0,
	.reg_spm_resource_req_rsv1_2_mask_b = 0,
	.reg_spm_resource_req_rsv1_1_mask_b = 0,
	.reg_spm_resource_req_rsv1_0_mask_b = 0,
	.reg_spm_resource_req_rsv0_4_mask_b = 0,
	.reg_spm_resource_req_rsv0_3_mask_b = 0,
	.reg_spm_resource_req_rsv0_2_mask_b = 0,
	.reg_spm_resource_req_rsv0_1_mask_b = 0,
	.reg_spm_resource_req_rsv0_0_mask_b = 0,
	.reg_srcclkeni2_cksel3_mask_b = 0,
	.reg_srcclkeni2_cksel2_mask_b = 0,
	.reg_srcclkeni1_cksel3_mask_b = 0,
	.reg_srcclkeni1_cksel2_mask_b = 0,
	.reg_srcclkeni0_cksel3_mask_b = 0,
	.reg_srcclkeni0_cksel2_mask_b = 0,
	.reg_md_ddr_en_0_dbc_en = 0,
	.reg_md_ddr_en_1_dbc_en = 0,
	.reg_conn_ddr_en_dbc_en = 0,
	.reg_sspm_mask_b = 0,
	.reg_md_0_mask_b = 0,
	.reg_md_1_mask_b = 0,
	.reg_scp_mask_b = 0,
	.reg_srcclkeni0_mask_b = 0,
	.reg_srcclkeni1_mask_b = 0,
	.reg_srcclkeni2_mask_b = 0,
	.reg_md_apsrc_1_sel = 0,
	.reg_md_apsrc_0_sel = 0,
	.reg_conn_mask_b = 0,
	.reg_conn_apsrc_sel = 0,
	.reg_md_srcclkena_0_vrf18_mask_b = 0,

	/* SPM_WAKEUP_EVENT_MASK */
	.reg_wakeup_event_mask = 0xFFFFFFFF,

	/* SPM_EXT_WAKEUP_EVENT_MASK */
	.reg_ext_wakeup_event_mask = 0xFFFFFFFF,

	/* SLEEP_MCU0_WFI_EN */
	.mcu0_wfi_en = 1,

	/* SLEEP_MCU1_WFI_EN */
	.mcu1_wfi_en = 1,

	/* SLEEP_MCU2_WFI_EN */
	.mcu2_wfi_en = 1,

	/* SLEEP_MCU3_WFI_EN */
	.mcu3_wfi_en = 1,

	/* SLEEP_MCU4_WFI_EN */
	.mcu4_wfi_en = 1,

	/* SLEEP_MCU5_WFI_EN */
	.mcu5_wfi_en = 1,

	/* SLEEP_MCU6_WFI_EN */
	.mcu6_wfi_en = 1,

	/* SLEEP_MCU7_WFI_EN */
	.mcu7_wfi_en = 1,

	/* SLEEP_MCU8_WFI_EN */
	.mcu8_wfi_en = 1,

	/* SLEEP_MCU9_WFI_EN */
	.mcu9_wfi_en = 1,

	/* SLEEP_MCU10_WFI_EN */
	.mcu10_wfi_en = 1,

	/* SLEEP_MCU11_WFI_EN */
	.mcu11_wfi_en = 1,

	/* SLEEP_MCU12_WFI_EN */
	.mcu12_wfi_en = 1,

	/* SLEEP_MCU13_WFI_EN */
	.mcu13_wfi_en = 1,

	/* SLEEP_MCU14_WFI_EN */
	.mcu14_wfi_en = 1,

	/* SLEEP_MCU15_WFI_EN */
	.mcu15_wfi_en = 0,

	/* SLEEP_MCU16_WFI_EN */
	.mcu16_wfi_en = 0,

	/* SLEEP_MCU17_WFI_EN */
	.mcu17_wfi_en = 0,

	/* Auto-gen End */
};

struct spm_lp_scen __spm_vcorefs = {
#ifdef CONFIG_FPGA_EARLY_PORTING
	.pcmdesc	= &vcorefs_pcm,
#endif
	.pwrctrl	= &vcorefs_ctrl,
};

static void dump_pmic_info(void)
{
#if !defined(CONFIG_FPGA_EARLY_PORTING)
	u32 reg_val;

	pmic_read_interface_nolock(MT6335_BUCK_VCORE_CON1, &reg_val, 0xffff, 0);
	spm_vcorefs_warn("[PMIC] selection in normal mode (SW mode): 0x%x\n", reg_val);

	pmic_read_interface_nolock(MT6335_BUCK_VCORE_CON2, &reg_val, 0xffff, 0);
	spm_vcorefs_warn("[PMIC] selection in sleep mode: 0x%x\n", reg_val);
#endif
}

char *spm_vcorefs_dump_dvfs_regs(char *p)
{
	if (p) {
		p += sprintf(p, "(v:%d)(r:%d)(c:%d)\n", plat_chip_ver, plat_lcd_resolution, plat_channel_num);
		#if 1
		dump_pmic_info();
		/* DVFSRC */
		p += sprintf(p, "DVFSRC_CHOOSE          : 0x%x\n", spm_read(DVFSRC_CHOOSE));
		p += sprintf(p, "DVFSRC_DEBUG_EN        : 0x%x\n", spm_read(DVFSRC_DEBUG_EN));
		p += sprintf(p, "DVFSRC_ENABLE          : 0x%x\n", spm_read(DVFSRC_ENABLE));
		p += sprintf(p, "DVFSRC_SIGNAL_CTRL     : 0x%x\n", spm_read(DVFSRC_SIGNAL_CTRL));
		p += sprintf(p, "DVFSRC_CPU_LEVEL_MASK  : 0x%x\n", spm_read(DVFSRC_CPU_LEVEL_MASK));
		p += sprintf(p, "DVFSRC_MD_LEVEL_MASK   : 0x%x\n", spm_read(DVFSRC_MD_LEVEL_MASK));
		p += sprintf(p, "DVFSRC_CHANNEL_MASK    : 0x%x\n", spm_read(DVFSRC_CHANNEL_MASK));
		p += sprintf(p, "DVFSRC_OVL_LEVEL_MASK  : 0x%x\n", spm_read(DVFSRC_OVL_LEVEL_MASK));
		p += sprintf(p, "DVFSRC_LEVEL_JMP_METHOD: 0x%x\n", spm_read(DVFSRC_LEVEL_JMP_METHOD));
		p += sprintf(p, "DVFSRC_M3733           : 0x%x\n", spm_read(DVFSRC_M3733));
		p += sprintf(p, "DVFSRC_M3200           : 0x%x\n", spm_read(DVFSRC_M3200));
		p += sprintf(p, "DVFSRC_M1600           : 0x%x\n", spm_read(DVFSRC_M1600));
		p += sprintf(p, "DVFSRC_TOTAL_AVG_MBW   : 0x%x\n", spm_read(DVFSRC_TOTAL_AVG_MBW));
		p += sprintf(p, "DVFSRC_STATUS          : 0x%x\n", spm_read(DVFSRC_STATUS));
		p += sprintf(p, "DVFSRC_BANDWIDTH_CONST1: 0x%x\n", spm_read(DVFSRC_BANDWIDTH_CONST1));
		p += sprintf(p, "DVFSRC_BANDWIDTH_CONST2: 0x%x\n", spm_read(DVFSRC_BANDWIDTH_CONST2));
		p += sprintf(p, "DVFSRC_RECORD_0~3      : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(DVFSRC_RECORD_0), spm_read(DVFSRC_RECORD_1),
								spm_read(DVFSRC_RECORD_2), spm_read(DVFSRC_RECORD_3));
		p += sprintf(p, "DVFSRC_RECORD_4~7      : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(DVFSRC_RECORD_4), spm_read(DVFSRC_RECORD_5),
								spm_read(DVFSRC_RECORD_6), spm_read(DVFSRC_RECORD_7));
		p += sprintf(p, "DVFSRC_RECORD_L_0~3    : 0x%x, 0x%x, 0x%x, 0x%x\n",
							spm_read(DVFSRC_RECORD_0_L), spm_read(DVFSRC_RECORD_1_L),
							spm_read(DVFSRC_RECORD_2_L), spm_read(DVFSRC_RECORD_3_L));
		p += sprintf(p, "DVFSRC_RECORD_L_4~7    : 0x%x, 0x%x, 0x%x, 0x%x\n",
							spm_read(DVFSRC_RECORD_4_L), spm_read(DVFSRC_RECORD_5_L),
							spm_read(DVFSRC_RECORD_6_L), spm_read(DVFSRC_RECORD_7_L));
		/* SPM */
		p += sprintf(p, "SPM_SW_FLAG            : 0x%x\n", spm_read(SPM_SW_FLAG));
		p += sprintf(p, "DVFS_LEVEL             : 0x%x\n", spm_read(DVFS_LEVEL));
		p += sprintf(p, "SPM_SW_RSV_5           : 0x%x\n", spm_read(SPM_SW_RSV_5));
		p += sprintf(p, "SPM_IRQ_STA            : 0x%x\n", spm_read(SPM_IRQ_STA));

		p += sprintf(p, "SPM_PC_TRACE_G0~G3     : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(SPM_PC_TRACE_G0), spm_read(SPM_PC_TRACE_G1),
								spm_read(SPM_PC_TRACE_G2), spm_read(SPM_PC_TRACE_G3));
		p += sprintf(p, "SPM_PC_TRACE_G4~G7     : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(SPM_PC_TRACE_G4), spm_read(SPM_PC_TRACE_G5),
								spm_read(SPM_PC_TRACE_G6), spm_read(SPM_PC_TRACE_G7));
		p += sprintf(p, "PCM_REG_DATA_0~3       : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG0_DATA), spm_read(PCM_REG1_DATA),
								spm_read(PCM_REG2_DATA), spm_read(PCM_REG3_DATA));
		p += sprintf(p, "PCM_REG_DATA_4~7       : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG4_DATA), spm_read(PCM_REG5_DATA),
								spm_read(PCM_REG6_DATA), spm_read(PCM_REG7_DATA));
		p += sprintf(p, "PCM_REG_DATA_8~11      : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG8_DATA), spm_read(PCM_REG9_DATA),
								spm_read(PCM_REG10_DATA), spm_read(PCM_REG11_DATA));
		p += sprintf(p, "PCM_REG_DATA_12~15     : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG12_DATA), spm_read(PCM_REG13_DATA),
								spm_read(PCM_REG14_DATA), spm_read(PCM_REG15_DATA));
		p += sprintf(p, "PCM_IM_PTR             : 0x%x (%u)\n", spm_read(PCM_IM_PTR), spm_read(PCM_IM_LEN));
		#endif
	} else {
		spm_vcorefs_warn("(v:%d)(r:%d)(c:%d)\n", plat_chip_ver, plat_lcd_resolution, plat_channel_num);
		#if 1
		/* DVFSRC */
		dump_pmic_info();
		spm_vcorefs_warn("DVFSRC_CHOOSE          : 0x%x\n", spm_read(DVFSRC_CHOOSE));
		spm_vcorefs_warn("DVFSRC_DEBUG_EN        : 0x%x\n", spm_read(DVFSRC_DEBUG_EN));
		spm_vcorefs_warn("DVFSRC_ENABLE          : 0x%x\n", spm_read(DVFSRC_ENABLE));
		spm_vcorefs_warn("DVFSRC_SIGNAL_CTRL     : 0x%x\n", spm_read(DVFSRC_SIGNAL_CTRL));
		spm_vcorefs_warn("DVFSRC_CPU_LEVEL_MASK  : 0x%x\n", spm_read(DVFSRC_CPU_LEVEL_MASK));
		spm_vcorefs_warn("DVFSRC_MD_LEVEL_MASK   : 0x%x\n", spm_read(DVFSRC_MD_LEVEL_MASK));
		spm_vcorefs_warn("DVFSRC_CHANNEL_MASK    : 0x%x\n", spm_read(DVFSRC_CHANNEL_MASK));
		spm_vcorefs_warn("DVFSRC_OVL_LEVEL_MASK  : 0x%x\n", spm_read(DVFSRC_OVL_LEVEL_MASK));
		spm_vcorefs_warn("DVFSRC_LEVEL_JMP_METHOD: 0x%x\n", spm_read(DVFSRC_LEVEL_JMP_METHOD));
		spm_vcorefs_warn("DVFSRC_M3733           : 0x%x\n", spm_read(DVFSRC_M3733));
		spm_vcorefs_warn("DVFSRC_M3200           : 0x%x\n", spm_read(DVFSRC_M3200));
		spm_vcorefs_warn("DVFSRC_M1600           : 0x%x\n", spm_read(DVFSRC_M1600));
		spm_vcorefs_warn("DVFSRC_STATUS          : 0x%x\n", spm_read(DVFSRC_STATUS));
		spm_vcorefs_warn("DVFSRC_TOTAL_AVG_MBW   : 0x%x\n", spm_read(DVFSRC_TOTAL_AVG_MBW));
		spm_vcorefs_warn("DVFSRC_BANDWIDTH_CONST1: 0x%x\n", spm_read(DVFSRC_BANDWIDTH_CONST1));
		spm_vcorefs_warn("DVFSRC_BANDWIDTH_CONST2: 0x%x\n", spm_read(DVFSRC_BANDWIDTH_CONST2));
		spm_vcorefs_warn("DVFSRC_RECORD_0~3      : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(DVFSRC_RECORD_0), spm_read(DVFSRC_RECORD_1),
								spm_read(DVFSRC_RECORD_2), spm_read(DVFSRC_RECORD_3));
		spm_vcorefs_warn("DVFSRC_RECORD_4~7      : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(DVFSRC_RECORD_4), spm_read(DVFSRC_RECORD_5),
								spm_read(DVFSRC_RECORD_6), spm_read(DVFSRC_RECORD_7));
		spm_vcorefs_warn("DVFSRC_RECORD_L_0~3    : 0x%x, 0x%x, 0x%x, 0x%x\n",
							spm_read(DVFSRC_RECORD_0_L), spm_read(DVFSRC_RECORD_1_L),
							spm_read(DVFSRC_RECORD_2_L), spm_read(DVFSRC_RECORD_3_L));
		spm_vcorefs_warn("DVFSRC_RECORD_L_4~7    : 0x%x, 0x%x, 0x%x, 0x%x\n",
							spm_read(DVFSRC_RECORD_4_L), spm_read(DVFSRC_RECORD_5_L),
							spm_read(DVFSRC_RECORD_6_L), spm_read(DVFSRC_RECORD_7_L));
		/* SPM */
		spm_vcorefs_warn("SPM_SW_FLAG            : 0x%x\n", spm_read(SPM_SW_FLAG));
		spm_vcorefs_warn("DVFS_LEVEL             : 0x%x\n", spm_read(DVFS_LEVEL));
		spm_vcorefs_warn("SPM_SW_RSV_5           : 0x%x\n", spm_read(SPM_SW_RSV_5));
		spm_vcorefs_warn("SPM_IRQ_STA            : 0x%x\n", spm_read(SPM_IRQ_STA));
		spm_vcorefs_warn("SPM_PC_TRACE_G0~G3     : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(SPM_PC_TRACE_G0), spm_read(SPM_PC_TRACE_G1),
								spm_read(SPM_PC_TRACE_G2), spm_read(SPM_PC_TRACE_G3));
		spm_vcorefs_warn("SPM_PC_TRACE_G4~G7     : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(SPM_PC_TRACE_G4), spm_read(SPM_PC_TRACE_G5),
								spm_read(SPM_PC_TRACE_G6), spm_read(SPM_PC_TRACE_G7));
		spm_vcorefs_warn("PCM_REG_DATA_0~3       : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG0_DATA), spm_read(PCM_REG1_DATA),
								spm_read(PCM_REG2_DATA), spm_read(PCM_REG3_DATA));
		spm_vcorefs_warn("PCM_REG_DATA_4~7       : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG4_DATA), spm_read(PCM_REG5_DATA),
								spm_read(PCM_REG6_DATA), spm_read(PCM_REG7_DATA));
		spm_vcorefs_warn("PCM_REG_DATA_8~11      : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG8_DATA), spm_read(PCM_REG9_DATA),
								spm_read(PCM_REG10_DATA), spm_read(PCM_REG11_DATA));
		spm_vcorefs_warn("PCM_REG_DATA_12~15     : 0x%x, 0x%x, 0x%x, 0x%x\n",
								spm_read(PCM_REG12_DATA), spm_read(PCM_REG13_DATA),
								spm_read(PCM_REG14_DATA), spm_read(PCM_REG15_DATA));
		spm_vcorefs_warn("PCM_IM_PTR             : 0x%x (%u)\n", spm_read(PCM_IM_PTR), spm_read(PCM_IM_LEN));
		#endif
	}

	return p;
}

/*
 * condition: false will loop for check
 */
#define wait_spm_complete_by_condition(condition, timeout)	\
({								\
	int i = 0;						\
	while (!(condition)) {					\
		if (i >= (timeout)) {				\
			i = -EBUSY;				\
			break;					\
		}						\
		udelay(1);					\
		i++;						\
	}							\
	i;							\
})

u32 spm_vcorefs_get_MD_status(void)
{
	return spm_read(MD2SPM_DVFS_CON);
}

static void spm_dvfsfw_init(int curr_opp, u32 channel)
{
	unsigned long flags;

	spin_lock_irqsave(&__spm_lock, flags);

	mt_secure_call(MTK_SIP_KERNEL_SPM_VCOREFS_ARGS, VCOREFS_SMC_CMD_0, curr_opp, channel);

	spin_unlock_irqrestore(&__spm_lock, flags);

	spm_vcorefs_warn("DVFS_LEVEL: 0x%x, curr_opp: %u, channel:%d\n", spm_read(DVFS_LEVEL), curr_opp, channel);
}

void __spm_sync_vcore_dvfs_power_control(struct pwr_ctrl *dest_pwr_ctrl, const struct pwr_ctrl *src_pwr_ctrl)
{
	u32 dvfs_mask =  SPM_FLAG_DIS_VCORE_DVS | SPM_FLAG_DIS_VCORE_DFS;

	/* SPM_SRC_REQ */
	dest_pwr_ctrl->reg_spm_dvfs_level0_req = src_pwr_ctrl->reg_spm_dvfs_level0_req;
	dest_pwr_ctrl->reg_spm_dvfs_level1_req = src_pwr_ctrl->reg_spm_dvfs_level1_req;
	dest_pwr_ctrl->reg_spm_dvfs_level2_req = src_pwr_ctrl->reg_spm_dvfs_level2_req;
	dest_pwr_ctrl->reg_spm_dvfs_level3_req = src_pwr_ctrl->reg_spm_dvfs_level3_req;
	dest_pwr_ctrl->reg_spm_dvfs_level4_req = src_pwr_ctrl->reg_spm_dvfs_level4_req;

	/* SPM_SRC2_MASK */
	dest_pwr_ctrl->reg_next_dvfs_level0_mask_b = src_pwr_ctrl->reg_next_dvfs_level0_mask_b;
	dest_pwr_ctrl->reg_next_dvfs_level1_mask_b = src_pwr_ctrl->reg_next_dvfs_level1_mask_b;
	dest_pwr_ctrl->reg_next_dvfs_level2_mask_b = src_pwr_ctrl->reg_next_dvfs_level2_mask_b;
	dest_pwr_ctrl->reg_next_dvfs_level3_mask_b = src_pwr_ctrl->reg_next_dvfs_level3_mask_b;
	dest_pwr_ctrl->reg_next_dvfs_level4_mask_b = src_pwr_ctrl->reg_next_dvfs_level4_mask_b;

	dest_pwr_ctrl->pcm_flags = (dest_pwr_ctrl->pcm_flags & (~dvfs_mask)) |
					(src_pwr_ctrl->pcm_flags & dvfs_mask);

	if (dest_pwr_ctrl->pcm_flags_cust)
		dest_pwr_ctrl->pcm_flags_cust = (dest_pwr_ctrl->pcm_flags_cust & (~dvfs_mask)) |
						(src_pwr_ctrl->pcm_flags & dvfs_mask);
}

int spm_vcorefs_pwarp_cmd(void)
{
#ifndef CONFIG_MTK_TINYSYS_SSPM_SUPPORT
	/* PMIC_WRAP_PHASE_ALLINONE */
	mt_spm_pmic_wrap_set_cmd(PMIC_WRAP_PHASE_ALLINONE, IDX_ALL_VCORE_LEVEL3, get_vcore_ptp_volt(OPP_0));
	mt_spm_pmic_wrap_set_cmd(PMIC_WRAP_PHASE_ALLINONE, IDX_ALL_VCORE_LEVEL2, get_vcore_ptp_volt(OPP_1));
	mt_spm_pmic_wrap_set_cmd(PMIC_WRAP_PHASE_ALLINONE, IDX_ALL_VCORE_LEVEL1, get_vcore_ptp_volt(OPP_2));
	mt_spm_pmic_wrap_set_cmd(PMIC_WRAP_PHASE_ALLINONE, IDX_ALL_VCORE_LEVEL0, get_vcore_ptp_volt(OPP_3));

	mt_spm_pmic_wrap_set_phase(PMIC_WRAP_PHASE_ALLINONE);

	spm_vcorefs_warn(">>> spm_vcorefs_pwarp_cmd\n");
#endif
	return 0;
}

int spm_vcorefs_get_opp(void)
{
	unsigned long flags;
	u32 dvfs_level[NUM_OPP] = { 0x10, 0x4, 0x2, 0x1};
	int level;

	if (is_vcorefs_can_work() == 1) {
		spin_lock_irqsave(&__spm_lock, flags);

		level = get_dvfs_level();

		if (level == dvfs_level[OPP_0])
			level = OPP_0;
		else if (level == dvfs_level[OPP_2])
			level = OPP_2;
		else if (level == dvfs_level[OPP_3])
			level = OPP_3;
		else
			level = OPP_1; /* 0x8(2ch), 0x4(4ch) */

		spin_unlock_irqrestore(&__spm_lock, flags);
	} else {
			level = BOOT_UP_OPP;
	}

	return level;
}

int ddr800_en;
static int spm_trigger_dvfs(int kicker, int opp, bool fix)
{
	u32 mask;
	int r = 0;

	u32 dvfs_mask_fix[NUM_OPP] = { 0x7, 0xb, 0xd, 0xd};
	u32 dvfs_mask[NUM_OPP] = { 0x7, 0x3, 0x1, 0x1};
	u32 dvfs_level[NUM_OPP] = { 0x10, 0x4, 0x2, 0x2};

	if (kicker == KIR_DDR800) {
		ddr800_en = 1;
		return 0;
	}

	if (ddr800_en == 1) {
		dvfs_mask_fix[3] = 0xe;
		dvfs_mask[3] = 0x0;
		dvfs_level[3] = 0x1;
	}

	if (fix)
		mask = dvfs_mask_fix[opp];
	else
		mask = dvfs_mask[opp];

	if (plat_channel_num == 2)
		dvfs_level[OPP_1] = 0x8;
	else if (plat_channel_num == 4)
		dvfs_level[OPP_1] = 0x4;

#if 1
	/* check DVFS idle */
	r = wait_spm_complete_by_condition(is_dvfs_in_progress(), SPM_DVFS_TIMEOUT);
	if (r < 0) {
		spm_vcorefs_dump_dvfs_regs(NULL);
		/* aee_kernel_warning("SPM Warring", "Vcore DVFS timeout warning"); */
		return -1;
	}
#endif

	spm_write(DVFSRC_CPU_LEVEL_MASK, (spm_read(DVFSRC_CPU_LEVEL_MASK) & ~(0xf)) | mask);

	vcorefs_crit_mask(log_mask(), kicker, "[%s] fix: %d, opp: %d, CPU_LEVEL_MASK: 0x%x (v:%d)(r:%d)(c:%d)\n",
				__func__, fix, opp, spm_read(DVFSRC_CPU_LEVEL_MASK),
				plat_chip_ver, plat_lcd_resolution, plat_channel_num);

#if 1
	/* check DVFS timer */
	if (fix)
		r = wait_spm_complete_by_condition(get_dvfs_level() == dvfs_level[opp], SPM_DVFS_TIMEOUT);
	else
		r = wait_spm_complete_by_condition(get_dvfs_level() >= dvfs_level[opp], SPM_DVFS_TIMEOUT);

	if (r < 0) {
		spm_vcorefs_dump_dvfs_regs(NULL);
		/* aee_kernel_warning("SPM Warring", "Vcore DVFS timeout warning"); */
		return -1;
	}
#endif

	return 0;
}

void spm_dvfsrc_set_channel_bw(enum dvfsrc_channel channel)
{
	plat_channel_num = channel;

	switch (channel) {
	case DVFSRC_CHANNEL_2:
		spm_write(DVFSRC_CHOOSE, spm_read(DVFSRC_CHOOSE) & ~(1U << 0)); /* DVFS mapping table by channel*/
		spm_write(DVFSRC_ENABLE, spm_read(DVFSRC_ENABLE) & ~(1U << 2)); /* BW by channel */

		if (plat_chip_ver == CHIP_SW_VER_01) {
			/* E1 C+G jump level */
			spm_write(DVFSRC_SIGNAL_CTRL, 0xc00aa2);
		} else {
			/* E2 C+G jump level */
			spm_write(DVFSRC_SIGNAL_CTRL, 0x800aa2);
		}

		if (plat_chip_ver == CHIP_SW_VER_01) {
			/* E1 HRT WQHD/FHD */
			spm_write(DVFSRC_M3733, 0xa60b4); /* >5.3G to opp0 */
			spm_write(DVFSRC_M3200, 0xa6087); /* >5.3G to opp0 */
			spm_write(DVFSRC_M1600, 0x3205a); /* >1.6G to opp2 */
		} else {
			#ifdef CONFIG_MTK_SMI_EXT
			/* panel resolution */
			if (plat_lcd_resolution == MMDVFS_LCD_SIZE_WQHD) {
				/* E2 HRT WQHD */
				spm_write(DVFSRC_M3733, 0xc80b4); /* >6.4G to opp0 */
				spm_write(DVFSRC_M3200, 0xa6087); /* >5.3G to opp1 */
				spm_write(DVFSRC_M1600, 0x6405a); /* >3.2G to opp2 */
			} else if (plat_lcd_resolution == MMDVFS_LCD_SIZE_FHD) {
				/* E2 HRT FHD */
				spm_write(DVFSRC_M3733, 0xc80b4); /* >6.4G to opp0 */
				spm_write(DVFSRC_M3200, 0xa6087); /* >5.3G to opp1 */
				spm_write(DVFSRC_M1600, 0x5305a); /* >2.7G to opp2 */
			}
			#endif
		}

		break;
	case DVFSRC_CHANNEL_4:
		spm_write(DVFSRC_CHOOSE, spm_read(DVFSRC_CHOOSE) | (1U << 0));
		spm_write(DVFSRC_ENABLE, spm_read(DVFSRC_ENABLE) | (1U << 2));

		if (plat_chip_ver == CHIP_SW_VER_01) {
			/* E1 C+G jump level*/
			spm_write(DVFSRC_SIGNAL_CTRL, 0xc00aa2);
		} else {
			/* E2 C+G jump level */
			spm_write(DVFSRC_SIGNAL_CTRL, 0xc00aa2);
		}

		if (plat_chip_ver == CHIP_SW_VER_01) {
			/* E1 HRT WQHD/FHD */
			spm_write(DVFSRC_M3733, 0xa60b4); /* >10.6G to opp0 */
			spm_write(DVFSRC_M3200, 0xa6087); /* >10.6G to opp0 */
			spm_write(DVFSRC_M1600, 0x3205a); /* >3.2G to opp2 */
		} else {
			#ifdef CONFIG_MTK_SMI_EXT
			/* panel resolution */
			if (plat_lcd_resolution == MMDVFS_LCD_SIZE_WQHD) {
				/* E2 HRT WQHD */
				spm_write(DVFSRC_M3733, 0xa60b4); /* >10.6G to opp0 */
				spm_write(DVFSRC_M3200, 0xa6087); /* >10.6G to opp0 */
				spm_write(DVFSRC_M1600, 0x6405a); /* >6.4G to opp2 */
			} else if (plat_lcd_resolution == MMDVFS_LCD_SIZE_FHD) {
				/* E2 HRT FHD */
				spm_write(DVFSRC_M3733, 0xa60b4); /* >10.6G to opp0 */
				spm_write(DVFSRC_M3200, 0xa6087); /* >10.6G to opp0 */
				spm_write(DVFSRC_M1600, 0x5305a); /* >5.3G to opp2 */
			}
			#endif
		}

		break;
	default:
		spm_vcorefs_err("WRONG channel number: %d\n", channel);
	}
}

void spm_dvfsrc_hrt_bw_config(enum dvfsrc_hrt_kir hrt_kir, bool config)
{
	switch (hrt_kir) {
	case DVFSRC_HRT_MM:
		spm_write(DVFSRC_CHANNEL_MASK, (spm_read(DVFSRC_CHANNEL_MASK) & ~(1U << 24)) | (config << 24));
		break;
	case DVFSRC_HRT_CAM:
		spm_write(DVFSRC_CHANNEL_MASK, (spm_read(DVFSRC_CHANNEL_MASK) & ~(1U << 26)) | (config << 26));
		break;
	case DVFSRC_HRT_MD:
		spm_write(DVFSRC_CHANNEL_MASK, (spm_read(DVFSRC_CHANNEL_MASK) & ~(1U << 28)) | (config << 28));
		break;
	default:
		spm_vcorefs_warn("UN-KNOW HRT KICKER: %d\n", hrt_kir);
	}
	spm_vcorefs_warn("HRT KIR: %d, config: %d, DVFSRC_CHANNEL_MASK: 0x%x\n", hrt_kir, config,
										spm_read(DVFSRC_CHANNEL_MASK));
}

int spm_dvfs_flag_init(void)
{
	int flag = SPM_FLAG_RUN_COMMON_SCENARIO;

	if (!vcorefs_vcore_dvs_en())
		flag |= SPM_FLAG_DIS_VCORE_DVS;
	if (!vcorefs_dram_dfs_en())
		flag |= SPM_FLAG_DIS_VCORE_DFS;

	/* flag = SPM_FLAG_RUN_COMMON_SCENARIO | SPM_FLAG_DIS_VCORE_DVS | SPM_FLAG_DIS_VCORE_DFS; */

	return flag;
}

static void dvfsrc_init(void)
{
	unsigned long flags;
	u32 dvfs_mask[NUM_OPP] = { 0x7, 0x3, 0x1, 0x0};

	spin_lock_irqsave(&__spm_lock, flags);

	if (plat_channel_num == 2)
		spm_dvfsrc_set_channel_bw(DVFSRC_CHANNEL_2);
	else if (plat_channel_num == 4)
		spm_dvfsrc_set_channel_bw(DVFSRC_CHANNEL_4);

	spm_write(DVFSRC_DEBUG_EN, 0x49);
	spm_write(DVFSRC_CHANNEL_MASK, 0x201fffff);
	spm_write(DVFSRC_LEVEL_JMP_METHOD, 0x32C801fc);
	spm_write(DVFSRC_BANDWIDTH_CONST1, 0x04100000);
	spm_write(DVFSRC_BANDWIDTH_CONST2, 0x04104000);

	if (plat_chip_ver == CHIP_SW_VER_01)
		spm_write(DVFSRC_MD_LEVEL_MASK, 0xffff0001);
	else
		spm_write(DVFSRC_MD_LEVEL_MASK, 0xffff0001);

	spm_write(DVFSRC_MD_MAP_BW_0, 0x0);
	spm_write(DVFSRC_MD_MAP_BW_1, 0x20002);
	spm_write(DVFSRC_MD_MAP_BW_2, 0x20002);
	spm_write(DVFSRC_MD_MAP_BW_3, 0x20002);
	spm_write(DVFSRC_MD_MAP_BW_4, 0x80008);
	spm_write(DVFSRC_MD_MAP_BW_5, 0x80008);
	spm_write(DVFSRC_MD_MAP_BW_6, 0x90009);
	spm_write(DVFSRC_MD_MAP_BW_7, 0x90009);
	spm_write(DVFSRC_MD_MAP_BW_8, 0xb000b);
	spm_write(DVFSRC_MD_MAP_BW_9, 0xb000b);
	spm_write(DVFSRC_MD_MAP_BW_10, 0x0);
	spm_write(DVFSRC_MD_MAP_BW_11, 0x0);
	spm_write(DVFSRC_MD_MAP_BW_12, 0x0);
	spm_write(DVFSRC_MD_MAP_BW_13, 0x0);
	spm_write(DVFSRC_MD_MAP_BW_14, 0xf000f);
	spm_write(DVFSRC_MD_MAP_BW_15, 0xff00ff);

	spm_write(DVFSRC_MD_LEVEL_CTRL, 0x1);
	spm_write(DVFSRC_MD_LEVEL_CTRL_2, 0x1);

	spm_write(DVFSRC_CPU_LEVEL_MASK, (spm_read(DVFSRC_CPU_LEVEL_MASK) & ~(0xf)) | dvfs_mask[BOOT_UP_OPP]);

	/* enable DVFSRC */
	spm_write(DVFSRC_ENABLE, spm_read(DVFSRC_ENABLE) | (0x3));

	mtk_rgu_cfg_dvfsrc(1);

	spin_unlock_irqrestore(&__spm_lock, flags);
}

static void dvfsrc_register_init(void)
{
	struct device_node *node;

	/* dvfsrc */
	node = of_find_compatible_node(NULL, NULL, "mediatek,dvfsrc");
	if (!node) {
		spm_vcorefs_err("[DVFSRC] find node failed\n");
		goto dvfsrc_exit;
	}

	dvfsrc_base = of_iomap(node, 0);
	if (!dvfsrc_base) {
		spm_vcorefs_err("[DVFSRC] base failed\n");
		goto dvfsrc_exit;
	}

dvfsrc_exit:

	spm_vcorefs_warn("spm_dvfsrc_register_init: dvfsrc_base = %p\n", dvfsrc_base);
}

static void spm_check_status_before_dvfs(void)
{
	int flag;

	if (spm_read(PCM_REG15_DATA) != 0x0)
		return;

	flag = spm_dvfs_flag_init();

	spm_dvfsfw_init(spm_vcorefs_get_opp(), plat_channel_num);

	spm_go_to_vcorefs(flag);
}

int spm_set_vcore_dvfs(struct kicker_config *krconf)
{
	unsigned long flags;
	int r = 0;
	u32 autok_kir_group = AUTOK_KIR_GROUP;
	bool fix = (((1U << krconf->kicker) & autok_kir_group) || krconf->kicker == KIR_SYSFSX) &&
									krconf->opp != OPP_UNREQ;
	int opp = fix ? krconf->opp : krconf->dvfs_opp;

	spm_check_status_before_dvfs();

	spm_vcorefs_footprint(SPM_VCOREFS_ENTER);

	spin_lock_irqsave(&__spm_lock, flags);

	spm_vcorefs_footprint(SPM_VCOREFS_DVFS_START);

	r = spm_trigger_dvfs(krconf->kicker, opp, fix);

	spm_vcorefs_footprint(SPM_VCOREFS_DVFS_END);

	spm_vcorefs_footprint(SPM_VCOREFS_LEAVE);

	spin_unlock_irqrestore(&__spm_lock, flags);

	spm_vcorefs_footprint(0);

	return r;
}

void spm_go_to_vcorefs(int spm_flags)
{
	unsigned long flags;

	spm_vcorefs_warn("pcm_flag: 0x%x\n", spm_flags);

	spin_lock_irqsave(&__spm_lock, flags);

	mt_secure_call(MTK_SIP_KERNEL_SPM_VCOREFS_ARGS, VCOREFS_SMC_CMD_1, spm_flags, 0);

	spin_unlock_irqrestore(&__spm_lock, flags);

	spm_vcorefs_warn("[%s] done\n", __func__);
}

static void plat_info_init(void)
{
	/* HW chip version */
	plat_chip_ver = mt_get_chip_sw_ver();

	/* lcd resolution */
	#ifdef CONFIG_MTK_SMI_EXT
	plat_lcd_resolution = mmdvfs_get_lcd_resolution();
	#else
	plat_lcd_resolution = 46;
	#endif

	/* DRAM Channel */
	plat_channel_num = get_channel_lock(1);
	get_channel_unlock();

	spm_vcorefs_warn("chip_ver: %d, lcd_resolution: %d channel_num: %d\n",
						plat_chip_ver, plat_lcd_resolution, plat_channel_num);
}

void spm_vcorefs_init(void)
{
	int flag;

	dvfsrc_register_init();
	vcorefs_module_init();
	plat_info_init();

	if (!spm_load_firmware_status()) {
		spm_vcorefs_warn("[%s] SPM FIRMWARE IS NOT READY\n", __func__);
		return;
	}

	if (is_vcorefs_feature_enable()) {
		flag = spm_dvfs_flag_init();
		vcorefs_init_opp_table();
		spm_dvfsfw_init(BOOT_UP_OPP, plat_channel_num);
		spm_go_to_vcorefs(flag);
		dvfsrc_init();
		vcorefs_late_init_dvfs();
		spm_vcorefs_warn("[%s] DONE\n", __func__);
	} else {
		spm_vcorefs_warn("[%s] VCORE DVFS IS DISABLE\n", __func__);
	}
}

MODULE_DESCRIPTION("SPM VCORE-DVFS DRIVER");
